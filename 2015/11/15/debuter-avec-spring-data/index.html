<!DOCTYPE html>
<html>
  <head>
    
    <meta charset="utf-8">
    <title>Débuter avec spring data jpa</title>
    <meta name="author" content="">
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
    <link rel="shortcut icon" href="../../../../favicon.ico">
    
    <!-- Le styles -->
    <link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
    <link href="../../../../assets/css/style.css?v=6bea7144e8" rel="stylesheet">
    <link href="../../../../assets/css/syntax.css?v=6bea7144e8" rel="stylesheet">
    
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>

    <!-- Le theme options -->
    <script type="text/javascript" src="../../../../options.js"></script>
    <script type="text/javascript" src="../../../../assets/js/siteOptions.js?v=6bea7144e8"></script>
    
    <link rel="canonical" href="index.html" />
    <meta name="referrer" content="origin" />
    
    <meta property="og:site_name" content="Komi Serge Innocent" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Débuter avec spring data jpa" />
    <meta property="og:description" content="Une partie essentielle pour toute application, quel que soit le langage utilisé est la gestion des données, entendez par là l&#x27;enregistrement, la récupération et tout traitement qui peut être effectué.  En java, vous avez l&#x27;API JDBC qui est une première..." />
    <meta property="og:url" content="http://localhost:2368/2015/11/15/debuter-avec-spring-data/" />
    <meta property="article:published_time" content="2015-11-15T01:07:00.000Z" />
    <meta property="article:modified_time" content="2016-02-04T19:29:27.147Z" />
    <meta property="article:tag" content="spring" />
    <meta property="article:tag" content="spring data" />
    <meta property="article:tag" content="java" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Débuter avec spring data jpa" />
    <meta name="twitter:description" content="Une partie essentielle pour toute application, quel que soit le langage utilisé est la gestion des données, entendez par là l&#x27;enregistrement, la récupération et tout traitement qui peut être effectué.  En java, vous avez l&#x27;API JDBC qui est une première..." />
    <meta name="twitter:url" content="http://localhost:2368/2015/11/15/debuter-avec-spring-data/" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Komi Serge Innocent",
    "author": {
        "@type": "Person",
        "name": "Komi Serge Innocent",
        "image": "http://www.gravatar.com/avatar/0f6e262f82d057e17d5faa2aaf4a9a50",
        "url": "http://localhost:2368/author/centonni",
        "sameAs": "https://github.com/Centonni",
        "description": "Développeur java/java EE | Formateur pour @objisci | Open source "
    },
    "headline": "Débuter avec spring data jpa",
    "url": "http://localhost:2368/2015/11/15/debuter-avec-spring-data/",
    "datePublished": "2015-11-15T01:07:00.000Z",
    "dateModified": "2016-02-04T19:29:27.147Z",
    "keywords": "spring, spring data, java",
    "description": "Une partie essentielle pour toute application, quel que soit le langage utilisé est la gestion des données, entendez par là l&#x27;enregistrement, la récupération et tout traitement qui peut être effectué.  En java, vous avez l&#x27;API JDBC qui est une première..."
}
    </script>

    <meta name="generator" content="Ghost 0.7" />
    <link rel="alternate" type="application/rss+xml" title="Komi Serge Innocent" href="../../../../rss.3" />
    
    <style id="dbyll-options"></style>

    <script type="text/javascript"> siteOptions.setStyles(); </script>
  </head>
  <body class="post-template tag-spring tag-spring-data tag-java">
    <nav class="navbar navbar-default visible-xs" role="navigation">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header" id="mobile-contact-list">
        
        <a class="navbar-brand" href="../../../../index.html">
          <img src="https://avatars0.githubusercontent.com/u/1955872?v=3&amp;u=c38e665f38413fd3b17aaa14428d453ca9b455c2&amp;s=140" class="img-circle" style="width: 35px; height: 35px">
          Komi Serge Innocent
        </a>
      </div>

    </nav>

      <div class="col-sm-3 sidebar hidden-xs">
        <header class="sidebar-header" role="banner">
          <a href="../../../../index.html">
            <img src="https://avatars0.githubusercontent.com/u/1955872?v=3&amp;u=c38e665f38413fd3b17aaa14428d453ca9b455c2&amp;s=140" class="img-circle" />
          </a>
          <h3 class="title">
            <a href="../../../../index.html">Komi Serge Innocent</a>
          </h3>
        </header>

        <div id="bio" class="text-center">
          Développeur java/java EE | Formateur pour @objisci | Enthousiaste de l&#x27;Open source et de l&#x27;économie du libre | All things about java,spring,groovy
        </div>

        <div id="contact-list" class="text-center">
          <ul class="list-unstyled list-inline" id="contact-list-primary"></ul> <!-- filled with js -->
          <ul id="contact-list-secondary" class="list-unstyled list-inline"> <!-- filled with js -->
            <li>
              <a class="btn btn-default btn-sm" href="../../../../rss.3">
                <i class="fa fa-rss fa-lg"></i>
              </a>
            </li>
          </ul>
        </div>
      </div>
      

      <div class="col-sm-9 col-sm-offset-3">
        

<main class="content">
  <article class="post tag-spring tag-spring-data tag-java">

    <section class="page-header">
      <h1 class="post-title">Débuter avec spring data jpa</h1>
    </section>

    <section class="post-date">
      <time datetime="2015-11-15">15 Nov 2015</time>
    </section>

    <div class="col-sm-10 article_body">
      <section class="post-content">
        <p>Une partie essentielle pour toute application, quel que soit le langage utilisé est la gestion des données, entendez par là l'enregistrement, la récupération et tout traitement qui peut être effectué. <br />
En java, vous avez <strong>l'API JDBC</strong> qui est une première couche pour l'accès aux base de données relationneles, ensuite vient <strong>JPA</strong> qui apporte une couche d'abstraction nécessaire pour permettre de faire un mapping objet-relationnel entre nos objets java et la base de donnée! <br />
Le but de cet article est de montrer comment utiliser <strong>Spring data JPA</strong>, une librairie qui facilite l'accès aux données et qui se positionne au dessus de <strong>JPA</strong>. J'en ai déjà fait une présentation dans <a href="http://centonni.com/Spring-data/">un article précédent</a>, aussi je vais ici montrer comment le mettre en oeuvre dans un projet!</p>

<h3 id="leprojet">Le projet</h3>

<p>Nous allons créer une application dont le but sera d'enregistrer des articles d'un magasin dans une base de donnée! Ci-après le diagramme de classe pour montrer un peu ce que seront nos objets métiers. <br />
<img src="../../../../content/images/2016/02/diagram.png" alt="Diagramme de classes" /></p>

<p>Vous l'aurez sans doute compris, ce n'est pas une application complète de gestion de stock que nous allons mettre sur pied mais juste un exemple pour vous permettre de débuter avec <strong>spring data</strong>.</p>

<h3 id="crersonprojetsousmaven">Créer son projet sous maven</h3>

<p>Pour commencer nous allons créer un projet java sous <strong>maven</strong>. Les IDE actuels vous offrent cette possibilité de choisir le type de projet que vous voulez créer alors, je suppose que là pas de soucis pour vous chers lecteurs ;)</p>

<h3 id="modifierlefichierpomxmlpourajouterlesdpendancesncessaires">Modifier le fichier pom.xml pour ajouter les dépendances nécessaires</h3>

<p>Pour pouvoir utiliser <strong>spring data</strong> il nous faut ajouter la librairie correspondante dans nos dépendances et bien entendu intégrer le connecteur adéquat pour la base de donnée dans laquelle on souhaite sauvegarder les données. Pour notre exemple, nous allons utiliser <strong>mysql</strong> mais vous pouvez utiliser une autre base de données sans problème, <strong>spring data</strong> supporte la majorité des bases de données relationnelles.</p>

<p>Aussi, le fichier de configuration doit ressembler à ce qui suit:</p>

<pre><code class="language-prettyprint">&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;

  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;com.centonni.&lt;/groupId&gt;
  &lt;artifactId&gt;debut-spring-data&lt;/artifactId&gt;
  &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
  &lt;name&gt;Debuter avec spring data&lt;/name&gt;

    &lt;!-- Spring boot pour l'ajout automatique des dépendances nécessaires et l'autoconfiguration --&gt;
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;1.3.0.RELEASE&lt;/version&gt;
    &lt;/parent&gt;

    &lt;properties&gt;
        &lt;java.version&gt;1.8&lt;/java.version&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;!-- Spring data jpa --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;!-- Le connecteur mysql pour java --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;mysql&lt;/groupId&gt;
            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

&lt;/project&gt;  
</code></pre>

<h3 id="dfinirlesclassesentits">Définir les classes entités</h3>

<p>Les classes entités sont les objets de notre application qui vont en fait devenir des tables dans notre base de données. Dans notre modèle, nous avons deux classes, <strong>Article</strong> et <strong>Categorie</strong>.</p>

<p>La <strong>classe Article</strong> :</p>

<pre><code class="language-prettyprint">package com.centonni.debutspringdata;

import javax.persistence.Entity;  
import javax.persistence.GeneratedValue;  
import javax.persistence.GenerationType;  
import javax.persistence.Id;  
import javax.persistence.ManyToOne;

@Entity
public class Article {

    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    private Long id;
    private String designation;
    private Double prix;
    @ManyToOne
    private Categorie categorie;

    protected Article() {
    }

    public Article(String designation, Double prix, Categorie categorie) {
        this.designation = designation;
        this.prix = prix;
        this.categorie = categorie;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getDesignation() {
        return designation;
    }

    public void setDesignation(String designation) {
        this.designation = designation;
    }

    public Double getPrix() {
        return prix;
    }

    public void setPrix(Double prix) {
        this.prix = prix;
    }

    public Categorie getCategorie() {
        return categorie;
    }

    public void setCategorie(Categorie categorie) {
        this.categorie = categorie;
    }

}
</code></pre>

<p>La <strong>classe Categorie</strong></p>

<pre><code class="language-prettyprint">package com.centonni.debutspringdata;

import javax.persistence.Entity;  
import javax.persistence.GeneratedValue;  
import javax.persistence.GenerationType;  
import javax.persistence.Id;

@Entity
public class Categorie {

    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    private Long id;
    private String libele;

    protected Categorie() {
    }

    public Categorie(String libele) {
        this.libele = libele;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getLibele() {
        return libele;
    }

    public void setLibele(String libele) {
        this.libele = libele;
    }

}
</code></pre>

<p>Les classes <strong>Article et Categorie</strong> sont annotées avec <code>@Entity</code>, ceci pour indiquer à <strong>JPA</strong> que cette classe est une entité et sera donc crée dans la base de donnée comme une table.</p>

<p>Les différents attributs de ces classes seront mappés par <strong>JPA</strong> pour devenir les champs des différentes tables qui seront crées dans la base de données.</p>

<p>L'annotation <code>@Id</code> permet de préciser le champ qui sera l'identifiant de la table dans la base de données et <code>@GeneratedValue</code> permet de spécifier que l'identifiant devra être généré automatiquement.</p>

<h3 id="configurerlabasededonnes">Configurer la base de données</h3>

<p>Nous allons nous intéresser à la base de données maintenant, pour que notre application puisse se connecter à la base, nous devons lui fournir les informations d'accès (nom de la base, utilisateurs etc..).</p>

<p>Pour ce faire nous allons créer un fichier nommé <code>application.properties</code>, il est à placer dans le répertoire de ressources (<code>src/main/resources</code>) de votre projet maven. Il devra avoir les valeurs ci-après:</p>

<pre><code class="language-prettyprint">#chemin d'accès à la base de donnée
spring.datasource.url=jdbc:mysql://localhost/demodata  
#utilisateur de la base de données
spring.datasource.username=root  
#mot de passe de l'utilisateur de la base de données
spring.datasource.password=root  
</code></pre>

<p>Et voilà, c'est tout ce qu'il nous faut pour configurer la base de données! <strong>spring boot</strong> que nous avons ajouté comme librairie dans les  dépendances de notre projet va se charger de toute la configuration permettant la communication avec la base de données.</p>

<h3 id="crernosrequtesdinterrogationdelabasededonnes">Créer nos requêtes d'interrogation de la base de données</h3>

<p>Pour interagir avec la base de donnée <strong>spring data</strong> met  disposition un certain nombre d'interfaces spécialisées avec des méthodes <strong>CRUD</strong> permettant de faire des opérations de base sur n'importe quellle entité, à savoir la <strong>création</strong>, la <strong>mise à jour</strong>, la <strong>suppression</strong> et la <strong>lecture</strong> de données.</p>
      </section>

      <section class="tags">
        <i class="fa fa-tags"></i>
        <a href="../../../../tag/spring/index.html">spring</a>, <a href="../../../../tag/spring-data/index.html">spring data</a>, <a href="../../../../tag/java/index.html">java</a>
      </section>

      <hr/>

      <div>
        <section class="share col-sm-6">
          <h4 class="section-title">Share Post</h4>
          <a class="btn btn-default btn-sm" href="http://twitter.com/share?text=D%C3%A9buter%20avec%20spring%20data%20jpa&url=http://localhost:2368/2015/11/15/debuter-avec-spring-data/"
             onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
            <i class="fa fa-twitter fa-lg"></i>
            Twitter
          </a>
          <a class="btn btn-default btn-sm" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:2368/2015/11/15/debuter-avec-spring-data/"
             onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
            <i class="fa fa-facebook fa-lg"></i>
            Facebook
          </a>
          <a class="btn btn-default btn-sm" href="https://plus.google.com/share?url=http://localhost:2368/2015/11/15/debuter-avec-spring-data/"
             onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
            <i class="fa fa-google-plus fa-lg"></i>
            Google+
          </a>
        </section>

        <section class="col-sm-6 author">
          <img src="http://www.gravatar.com/avatar/0f6e262f82d057e17d5faa2aaf4a9a50" class="img-rounded author-image" />
          <h4 class="section-title author-name">Komi Serge Innocent</h4>
          <p class="author-bio">Développeur java/java EE | Formateur pour @objisci | Open source </p>
        </section>
      </div>

      <div class="clearfix"></div>

      <section class="comments" style="margin-top:15px;">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = site.disqus.shortname; // required: replace example with your forum shortname
          if(disqus_shortname){
            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
          }
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      </section>
    </div>

    <div class="clearfix"></div>

  </article>
</main>



        <footer class="site-footer">
          <hr/>
          <div class="inner">
            <section class="copyright">
              <a href="../../../../index.html">Komi Serge Innocent</a> &copy; 2016
              with <a href="index.html#">dbyll</a> theme on <a class="icon-ghost" href="http://ghost.org">Ghost</a>.
            </section>
          </div>
        </footer>

        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>  
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/locale/fr.js"></script>
<script type="text/javascript">  
$(document).ready(function () {
  moment.locale('fr');

  $('.post-date').children("time").each(function (i, date) {
    var $date = $(date);
      /*console.log($date.attr('datetime'));
      console.log(moment($date).format('LLLL'));*/
    $date.html(
      moment($date.attr('datetime'))
        .format('LL')
    );
    
  });
});
</script>
      </div>
      
      <div class="clearfix"></div>

      <script type="text/javascript" src="http://netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
      <script type="text/javascript" src="../../../../assets/js/app.js?v=6bea7144e8"></script>
      <script type="text/javascript" src="../../../../assets/js/run_prettify.js?v=6bea7144e8"></script>
      <script>
        if(site.analyticsTrackId){
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                                  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', site.analyticsTrackId);
          ga('send', 'pageview');
        }
      </script>
    </body>
  </html>
